# 乒乓球在线预约系统

一个完整的乒乓球场地在线预约平台，支持用户注册、预约管理、参与者评分等功能。

## 🎯 项目概述

本项目是一个乒乓球场地在线预约系统，用户可以通过该系统预约乒乓球台、加入他人预约、管理个人资料，并在预约完成后对其他参与者进行评分。

## 🌐 在线访问地址

**前端访问地址：**
```
https://blackcatandwhiterabbit.github.io/pingpong-booking-system/
```

**后端服务地址：**
```
https://pingpong-backend-203004-6-1388729431.sh.run.tcloudbase.com
```

## ✨ 主要功能

### 用户管理
- **用户注册与登录**：支持学号注册和登录
- **个人资料管理**：可设置个人简介和乒乓球水平等级
- **个人主页**：展示用户信息和评分统计

### 预约管理
- **创建预约**：可预约今天到未来14天内的乒乓球台
- **加入预约**：可加入他人创建的预约
- **取消预约**：发起者可在开场前2小时内取消预约
- **退出预约**：参与者可在特定条件下退出预约
- **预约状态管理**：自动处理预约状态（active → completed）

### 评分系统
- **相互评分**：预约参与者可以相互评分
- **评分维度**：实力评分（1-5分）和愉悦度评分（1-5分）
- **评分统计**：显示平均分和分数分布
- **五角星显示**：平均分以五角星形式直观展示
- **分数分布图**：显示各分数段的人数占比

### 历史预约管理
- **个人评分完成即消失**：用户完成评分后，预约从个人主页消失
- **独立状态跟踪**：每个用户的评分状态独立管理
- **预约清理**：所有参与者完成评分后，预约自动删除

## 🚀 快速开始

### 用户使用指南

#### 1. 注册账号
1. 访问系统首页
2. 点击"注册"按钮
3. 填写学号、姓名、密码完成注册
4. 注册成功后自动登录

#### 2. 创建预约
1. 登录后点击"发起预约"
2. 选择预约日期（今天、明天、后天或具体日期）
3. 选择时间段和球台号
4. 设置最大参与人数
5. 提交预约

#### 3. 加入预约
1. 在首页或"接受预约"页面查看可加入的预约
2. 点击"加入"按钮
3. 系统自动将您添加到参与者列表

#### 4. 评分功能
1. 预约结束后，在个人主页查看历史预约
2. 点击"为参与者评分"按钮
3. 为其他参与者进行实力和愉悦度评分
4. 评分完成后，预约从个人主页消失

## 🔧 技术架构

### 前端技术
- **HTML/CSS/JavaScript**：纯前端实现，无框架依赖
- **响应式设计**：适配不同屏幕尺寸
- **本地存储**：使用localStorage管理会话

### 后端技术
- **Node.js + Express**：轻量级后端框架
- **数据持久化**：JSON文件存储，支持服务器重启数据恢复
- **RESTful API**：标准的API设计

### 核心API端点
- `/api/register` - 用户注册
- `/api/login` - 用户登录
- `/api/bookings` - 预约管理
- `/api/ratings` - 评分管理
- `/api/users/:studentId/history` - 历史预约查询

## 📋 部署说明

### 前端部署（GitHub Pages）
1. **创建GitHub仓库**
   - 仓库名称：`pingpong-booking-system`
   - 设置为Public仓库
   - 上传所有前端文件

2. **配置GitHub Pages**
   - 进入仓库Settings → Pages
   - Source选择：Deploy from a branch
   - Branch选择：main
   - 保存设置

3. **访问地址**
   - `https://您的用户名.github.io/pingpong-booking-system/`

### 后端部署（腾讯云CloudBase）
1. **注册腾讯云账号**
   - 访问 cloud.tencent.com
   - 完成实名认证

2. **开通CloudBase服务**
   - 访问 cloud.tencent.com/product/tcb
   - 选择免费试用6个月套餐
   - 创建环境

3. **配置云托管服务**
   - 部署类型：容器性服务
   - Git仓库：`https://github.com/BlackCatAndWhiteRabbit/pingpong-booking-system`
   - 目标目录：`program/express`
   - 启动命令：`node server.js`
   - 端口：`3000`

4. **获取访问地址**
   - 部署成功后获得外网访问地址

## ⚠️ 使用注意事项

### 预约限制
- 每个用户最多同时发起5个预约
- 开场前2小时内不能取消预约
- 开场前2小时内且参与人数为2人时不能退出

### 评分规则
- 只能对已完成的预约进行评分
- 只能对其他参与者评分，不能对自己评分
- 评分完成后预约从个人主页消失

### 数据安全
- 所有用户数据使用学号作为唯一标识
- 密码在传输和存储过程中进行加密处理
- 会话信息存储在浏览器本地

## 🔄 维护和更新

### 前端更新
1. 在GitHub仓库中修改HTML/CSS/JavaScript文件
2. 提交更改到main分支
3. GitHub Pages会自动重新部署

### 后端更新
1. 修改Express目录下的代码
2. 提交到GitHub仓库
3. CloudBase会自动检测更改并重新部署

### 数据备份
- 用户数据、预约数据、评分数据存储在JSON文件中
- 建议定期备份 `program/express/data/` 目录下的文件

## 🛠️ 故障排除

### 常见问题

**1. 无法注册/登录**
- 检查网络连接
- 确认后端服务正常运行
- 检查学号格式是否正确

**2. 预约无法创建**
- 确认用户已登录
- 检查预约时间是否在有效范围内
- 确认没有超过最大预约数量限制

**3. 评分功能异常**
- 确认预约已结束
- 检查是否已经对其他参与者评分
- 刷新页面重试

**4. 后端服务无法访问**
- 检查CloudBase服务状态
- 确认域名是否在有效期内
- 查看部署日志排查问题

### 联系支持
如遇到技术问题，请检查：
1. 前端GitHub Pages状态
2. 后端CloudBase服务状态
3. 网络连接状况

## 📝 版本信息

- **当前版本**：v1.0
- **最后更新**：2025-11-27
- **部署状态**：✅ 生产环境运行中

## 📄 相关文档

- [项目详细说明](project.md)
- [API接口文档](API文档.md)
- [部署配置说明](部署指南.md)

---

**项目维护者**：刘宇轩  
**技术支持**：通过GitHub Issues提交问题
